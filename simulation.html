<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="base.css">
    <link rel="stylesheet" href="simulation.css">
    <title>Simulation</title>
</head>
<body>

<h1>Simulation</h1>

<nav>
    <a href="index.html">Back</a>
</nav>

<div class="encadre" id="budget-section">
    <h2>Budget</h2>
    <div class="budget-input">
        <input type="number" id="budget" oninput="filterBudget()">
        <span>€</span>
    </div>
    <div class="budget-images" id="budget-options">
        <div class="budget-item">Sketch</div>
        <div class="budget-item">Lineart</div>
        <div class="budget-item">Flat</div>
        <div class="budget-item">Render</div>
    </div>
</div>

<div class="encadre" id="category-section">
    <h2>Pick Your Style</h2>
    <div class="category-options" id="category-options">
    </div>
</div>

<div class="encadre" id="detail-section">
    <h2>Detail</h2>
    <div class="details-options" id="details-options">
    </div>
</div>

<div id="total-price"></div>

<h4 class="contact-text">
    If you're interested, you can contact me on
    <a href="https://www.tumblr.com/blog/noveltale" class="contact-link">Tumblr</a>
</h4>
<script>
let prices = {};
let selectedCategory = null;
let selectedDetail = null;

fetch('prices.json')
    .then(resp => resp.json())
    .then(data => prices = data)
    .catch(err => console.error('Error loading JSON:', err));

function filterBudget() {
    const budgetValue = parseFloat(document.getElementById('budget').value);
    const budgetItems = document.querySelectorAll('.budget-item');

    budgetItems.forEach(item => {
        const cat = item.textContent.toLowerCase();
        const minPrice = Math.min(...Object.values(prices[cat] || {}));
        if (!budgetValue || budgetValue < minPrice) {
            item.classList.add('inactive');
        } else {
            item.classList.remove('inactive');
        }
    });

    const categoryOptions = document.getElementById('category-options');
    categoryOptions.innerHTML = '';

    budgetItems.forEach(item => {
        if (!item.classList.contains('inactive')) {
            const div = document.createElement('div');
            div.classList.add('category-option');

            // Add image inside rectangle
            const img = document.createElement('img');
            img.src = `Commission_pictures/${item.textContent.toLowerCase()}.png`;
            img.alt = item.textContent;
            img.style.width = '100px';
            img.style.height = '100px';
            img.style.objectFit = 'cover';
            img.style.borderRadius = '8px';
            img.style.marginBottom = '5px';
            div.appendChild(img);

            // Add label
            const label = document.createElement('span');
            label.textContent = item.textContent;
            div.appendChild(label);

            div.onclick = () => selectCategory(item.textContent.toLowerCase());
            categoryOptions.appendChild(div);
        }
    });

    categoryOptions.style.display = budgetValue && budgetValue > 0 ? 'flex' : 'none';
    if (!budgetValue || budgetValue <= 0) {
        document.getElementById('details-options').style.display = 'none';
        document.getElementById('total-price').style.display = 'none';
    }
}

function selectCategory(cat) {
    selectedCategory = cat;
    selectedDetail = null;

    const allOptions = document.querySelectorAll('.category-option');
    allOptions.forEach(o => {
        o.classList.toggle('selected', o.textContent.toLowerCase() === cat);
    });

    const detailsDiv = document.getElementById('details-options');
    detailsDiv.innerHTML = '';
    ['head', 'bust', 'full'].forEach(part => {
        const div = document.createElement('div');
        div.classList.add('detail-item-circle');
        div.textContent = part.charAt(0).toUpperCase() + part.slice(1);
        div.onclick = () => selectDetail(part);
        detailsDiv.appendChild(div);
    });
    detailsDiv.style.display = 'flex';
    document.getElementById('total-price').style.display = 'none';
}

function selectDetail(part) {
    selectedDetail = part;

    const allDetails = document.querySelectorAll('.detail-item-circle');
    allDetails.forEach(d => {
        d.classList.toggle('selected', d.textContent.toLowerCase() === part);
    });

    if (selectedCategory && selectedDetail) {
        const price = prices[selectedCategory][selectedDetail];
        const totalDiv = document.getElementById('total-price');
        totalDiv.textContent = `This commission would cost ${price} €`;
        totalDiv.style.display = 'block';

        totalDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }
}
</script>

</body>
</html>
